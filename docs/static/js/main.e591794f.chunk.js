(this.webpackJsonpbsport_calendar=this.webpackJsonpbsport_calendar||[]).push([[0],{70:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),i=(a(40),a(30)),c=a.n(i),s=a(3),o=a.n(s),u=a(12),l=a(5),d=a(11),f=(a(45),a(31)),p=a.n(f),v=a(2),h=function(t){var e=t.value,a=void 0===e?new Date:e,r=t.onChange,i=Object(n.useMemo)((function(){return{mode:"range",dateFormat:"d-m-Y"}}),[]);return Object(v.jsx)(p.a,{className:"form-control",onChange:r,options:i,value:a})},b=a(74),m=a(75),j=a(4);var g=a(18),O=a.n(g);O.a.defaults.headers.common={Authorization:"Bearer ".concat("8c5ba20bc481c4d2803325833a5cf54771f6ba45")};var x=function(t,e){return O.a.get(t,{params:e}).then((function(t){return t.data})).catch((function(t){throw t}))},_={offer:{search:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.company,a=void 0===e?6:e,n=t.date_start,r=t.date,i=t.min_date,c=t.max_date,s=t.page,o=t.page_size;return x("https://api.staging.bsport.io/api/v1/offer/",{company:a,date:r,min_date:i,max_date:c,date_start:n,page:s,page_size:o})}},metaActivity:{search:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.company,a=void 0===e?6:e;return x("https://api.staging.bsport.io/api/v1/meta-activity/",{company:a})},get:function(t){var e=t.id;return x("https://api.staging.bsport.io/api/v1/meta-activity/".concat(e))}},coach:{search:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.company,a=void 0===e?6:e;return x("https://api.staging.bsport.io/api/v1/coach/",{company:a})},get:function(t){var e=t.id;return x("https://api.staging.bsport.io/api/v1/coach/".concat(e))}},establishment:{search:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.company,a=void 0===e?6:e;return x("https://api.staging.bsport.io/api/v1/establishment/",{company:a})},get:function(t){var e=t.id;return x("https://api.staging.bsport.io/api/v1/establishment/".concat(e))}},establishmentLocation:{search:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.company,a=void 0===e?6:e;return x("https://api.staging.bsport.io/api/v1/establishment/marker/",{company:a})}},booking:{search:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.offer_id,a=t.page,n=t.page_size;return x("https://api.staging.bsport.io/api/v1/booking/",{offer:e,page:a,page_size:n})}}};function y(t){var e,a,n,r;return{id:t.id,name:null===(e=t.user)||void 0===e?void 0:e.name,first_name:null===(a=t.user)||void 0===a?void 0:a.first_name,last_name:null===(n=t.user)||void 0===n?void 0:n.last_name,photo:null===(r=t.user)||void 0===r?void 0:r.photo}}var w=function(){var t=Object(l.a)(o.a.mark((function t(e){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,t.next=3,_.coach.get({id:a});case 3:return n=t.sent,t.abrupt("return",y(n));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function k(t){var e;return{id:t.id,title:t.title,address:null===(e=t.location)||void 0===e?void 0:e.address,specific_info:t.specific_info}}var Y=function(){var t=Object(l.a)(o.a.mark((function t(e){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,t.next=3,_.establishment.get({id:a});case 3:return n=t.sent,t.abrupt("return",k(n));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function M(t){return{id:t.id,name:t.name,cover_main:t.cover_main,description:t.description,color:t.color,rating:t.rating}}var z=function(){var t=Object(l.a)(o.a.mark((function t(e){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,t.next=3,_.metaActivity.get({id:a});case 3:return n=t.sent,t.abrupt("return",M(n));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function N(t){return{id:t.id,member:t.member}}var D,C=function(){var t=Object(l.a)(o.a.mark((function t(){var e,a,n=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{},t.next=3,_.booking.search(e);case 3:return a=t.sent,t.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(t){return N(t)}))}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),S=function(){var t=Object(l.a)(o.a.mark((function t(e){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.offer.search(Object(j.a)({},e));case 2:return a=t.sent,t.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(t){return{id:(e=t).id,booking_ids:e.bookings,level:e.level,slots:e.tot_slots,effectif:e.effectif,duration:e.duration_minute,validated_booking_count:e.validated_booking_count,date_start:e.date_start,establishment_id:e.establishment,coach_id:e.coach,activity_id:e.meta_activity};var e}))}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),A=function(){var t=Object(l.a)(o.a.mark((function t(e){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S(e);case 2:return a=t.sent,t.next=5,Promise.all(a.results.map(function(){var t=Object(l.a)(o.a.mark((function t(e){var a,n,r,i,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.allSettled([z({id:e.activity_id}),w({id:e.coach_id}),Y({id:e.establishment_id}),C({offer_id:e.id,page_size:e.effectif.length})]);case 2:return a=t.sent,n=Object(d.a)(a,4),r=n[0],i=n[1],c=n[2],s=n[3],e.activity="fulfilled"===r.status?r.value:null,e.coach="fulfilled"===i.status?i.value:null,e.establishment="fulfilled"===c.status?c.value:null,e.bookings="fulfilled"===s.status?s.value.results:[],t.abrupt("return",e);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return a.results=t.sent,t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),B=a(13),H=a.n(B),L=a(32),I=a.n(L),J=a(33),P=a(72),W=a(73),E=a(34).a.div(D||(D=Object(J.a)(["\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),F=function(t){var e,a,r,i,c,s,o,u,l=t.offer,d=Object(n.useMemo)((function(){return"".concat(H()(l.date_start).format("DD/MM/YYYY HH:mm")," - ").concat(H()(l.date_start).add(l.duration,"m").format("HH:mm"))}),[l]);return Object(v.jsxs)(P.a,{className:"mb-2",style:{borderBottomColor:null===(e=l.activity)||void 0===e?void 0:e.color,borderBottomWidth:2},children:[Object(v.jsx)("div",{className:"card-img-top",style:{height:200,backgroundImage:"url(".concat(null===l||void 0===l||null===(a=l.activity)||void 0===a?void 0:a.cover_main,")"),backgroundSize:"cover"}}),Object(v.jsxs)(W.a,{children:[Object(v.jsx)("h5",{children:Object(v.jsx)(E,{title:null===(r=l.activity)||void 0===r?void 0:r.name,children:null===(i=l.activity)||void 0===i?void 0:i.name})}),Object(v.jsxs)(E,{children:[Object(v.jsx)("i",{className:"far fa-calendar"}),"  ",Object(v.jsx)("span",{title:d,children:d})]}),Object(v.jsxs)(E,{children:[Object(v.jsx)("i",{className:"fas fa-map-marker-alt"})," ",Object(v.jsx)("span",{title:null===(c=l.establishment)||void 0===c?void 0:c.address,children:null===(s=l.establishment)||void 0===s?void 0:s.address})]}),Object(v.jsxs)(E,{children:[Object(v.jsx)("i",{className:"fas fa-user-tie"})," ",Object(v.jsx)("span",{title:null===(o=l.coach)||void 0===o?void 0:o.name,children:null===(u=l.coach)||void 0===u?void 0:u.name})]}),Object(v.jsxs)(E,{children:["Level: ",Object(v.jsx)("span",{title:l.value,children:l.level})]}),Object(v.jsxs)(E,{children:["Slots: ",l.validated_booking_count,"/",l.effectif]})]})]})},q={offers:[],total:0,size:10,page:0,fetching:!1},G=function(){var t=Object(n.useState)([new Date,new Date]),e=Object(d.a)(t,2),a=e[0],r=e[1],i=function(t){var e=Object(n.useState)(t),a=Object(d.a)(e,2),r=a[0],i=a[1];return[r,Object(n.useCallback)((function(t){i((function(e){return Object(j.a)(Object(j.a)({},e),t)}))}),[i])]}(q),c=Object(d.a)(i,2),s=c[0],f=s.offers,p=s.total,g=s.size,O=s.page,x=s.fetching,_=c[1],y=Object(n.useCallback)((function(t){2===t.length&&(r(t),_({page:0,offers:[],total:0}))}),[]),w=Object(n.useCallback)(Object(l.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return _({fetching:!0}),t.next=3,A({min_date:H()(a[0]).format("YYYY-MM-DD"),max_date:H()(a[1]).format("YYYY-MM-DD"),page:O+1,page_size:g});case 3:e=t.sent,_({total:e.count,page:O+1,offers:[].concat(Object(u.a)(f),Object(u.a)(e.results)),fetching:!1});case 5:case"end":return t.stop()}}),t)}))),[f,p]);return Object(v.jsxs)(b.a,{className:"d-flex flex-column overflow-auto",children:[Object(v.jsx)("h3",{children:"Search for activities"}),Object(v.jsx)("div",{className:"mb-3",children:Object(v.jsx)(h,{value:a,onChange:y})}),Object(v.jsx)(b.a,{fluid:!0,style:{overflowY:"auto"},children:Object(v.jsxs)(I.a,{pageStart:0,element:"div",initialLoad:!0,className:"row",hasMore:!x&&(p>f.length||0===O),loadMore:w,loader:null,threshold:30,useWindow:!1,children:[f.map((function(t){return Object(v.jsx)(m.a,{sm:4,children:Object(v.jsx)(F,{offer:t})},t.id)})),x&&Object(v.jsx)("div",{children:"Chargement..."})]})})]})};var K=function(){return Object(v.jsx)("div",{className:"App d-flex flex-column pt-2 pb-2",style:{height:"100vh"},children:Object(v.jsx)(G,{})})};c.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(K,{})}),document.getElementById("root"))}},[[70,1,2]]]);
//# sourceMappingURL=main.e591794f.chunk.js.map