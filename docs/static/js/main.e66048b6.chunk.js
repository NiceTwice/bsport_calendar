(this.webpackJsonpbsport_calendar=this.webpackJsonpbsport_calendar||[]).push([[0],{85:function(e,t,a){"use strict";a.r(t);var n=a(1),i=(a(48),a(14)),r=a.n(i),c=a(4),s=a.n(c),o=a(13),l=a(9),u=a(12),d=(a(53),a(41)),v=a.n(d),b=a(2),h=function(e){var t=e.value,a=e.onChange,i=Object(n.useMemo)((function(){return{mode:"range",dateFormat:"d-m-Y"}}),[]);return Object(b.jsx)(v.a,{className:"form-control",onChange:a,options:i,value:t})},p=a(94),f=a(95),j=a(6);var m=a(24),g=a.n(m);g.a.defaults.headers.common={Authorization:"Token ".concat("8c5ba20bc481c4d2803325833a5cf54771f6ba45")};var O=function(e,t){return g.a.get(e,{params:t}).then((function(e){return e.data})).catch((function(e){throw e}))},x={offer:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.date_start,i=e.date,r=e.min_date,c=e.max_date,s=e.page,o=e.page_size;return O("https://api.staging.bsport.io/api/v1/offer/",{company:a,date:i,min_date:r,max_date:c,date_start:n,page:s,page_size:o})}},metaActivity:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.ids,i=e.page_size,r=e.page;return O("https://api.staging.bsport.io/api/v1/meta-activity/",{company:a,id__in:(null===n||void 0===n?void 0:n.length)?n.join(","):void 0,page_size:i,page:r})},get:function(e){var t=e.id;return O("https://api.staging.bsport.io/api/v1/meta-activity/".concat(t))}},coach:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.ids,i=e.page_size,r=e.page;return O("https://api.staging.bsport.io/api/v1/coach/",{company:a,id__in:(null===n||void 0===n?void 0:n.length)?n.join(","):void 0,page_size:i,page:r})},get:function(e){var t=e.id;return O("https://api.staging.bsport.io/api/v1/coach/".concat(t))}},establishment:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.ids,i=e.page_size,r=e.page;return O("https://api.staging.bsport.io/api/v1/establishment/",{company:a,id__in:(null===n||void 0===n?void 0:n.length)?n.join(","):void 0,page_size:i,page:r})},get:function(e){var t=e.id;return O("https://api.staging.bsport.io/api/v1/establishment/".concat(t))}},establishmentLocation:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t;return O("https://api.staging.bsport.io/api/v1/establishment/marker/",{company:a})}},booking:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.offer_id,a=e.page,n=e.page_size;return O("https://api.staging.bsport.io/api/v1/booking/",{offer:t,page:a,page_size:n})}},member:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.offer_id,i=e.ids,r=e.page,c=e.page_size;return O("https://api.staging.bsport.io/api/v1/member/",{company:a,offer:n,page:r,page_size:c,id__in:(null===i||void 0===i?void 0:i.length)?i.join(","):void 0})}}};function _(e){var t,a,n,i;return{id:e.id,name:null===(t=e.user)||void 0===t?void 0:t.name,first_name:null===(a=e.user)||void 0===a?void 0:a.first_name,last_name:null===(n=e.user)||void 0===n?void 0:n.last_name,photo:null===(i=e.user)||void 0===i?void 0:i.photo}}var y=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,x.coach.search(t);case 3:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return _(e)}))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function w(e){var t;return{id:e.id,title:e.title,address:null===(t=e.location)||void 0===t?void 0:t.address,specific_info:e.specific_info}}var k=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,x.establishment.search(t);case 3:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return w(e)}))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function z(e){return{id:e.id,name:e.name,cover_main:e.cover_main,description:e.description,color:e.color,rating:e.rating}}var N=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,x.metaActivity.search(t);case 3:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return z(e)}))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.offer.search(Object(j.a)({},t));case 2:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return{id:(t=e).id,booking_ids:t.bookings,level:t.level,slots:t.tot_slots,effectif:t.effectif,duration:t.duration_minute,validated_booking_count:t.validated_booking_count,date_start:t.date_start,establishment_id:t.establishment,coach_id:t.coach,activity_id:t.meta_activity};var t}))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(l.a)(s.a.mark((function e(t){var a,n,i,r,c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:return a=e.sent,e.next=5,Promise.all([N({ids:a.results.map((function(e){return e.activity_id})),page_size:a.results.length}),k({ids:a.results.map((function(e){return e.establishment_id})),page_size:a.results.length}),y({ids:a.results.map((function(e){return e.coach_id})),page_size:a.results.length})]);case 5:return n=e.sent,i=Object(u.a)(n,3),r=i[0],c=i[1],o=i[2],a.results=a.results.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{activity:r.results.find((function(t){return t.id===e.activity_id})),coach:o.results.find((function(t){return t.id===e.coach_id})),establishment:c.results.find((function(t){return t.id===e.establishment_id}))})})),e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=a(16),S=a.n(M),D=a(42),A=a.n(D),H=a(19),B=a(92),L=a(93),T=a(91),E=a(20),I=a(96),J=a(87),R=a(88),W=a(89),F=a(90);function G(e){return Object(j.a)({},e)}var P,q,K=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,x.member.search(t);case 3:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return G(e)}))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=a(46),U=["className"],V=E.a.img(P||(P=Object(H.a)(["\n  width: 40px;\n  height: 40px;\n"]))),X=function(e){var t=e.className,a=Object(Q.a)(e,U);return Object(b.jsx)(V,Object(j.a)({className:"rounded-circle ".concat(t||"")},a))},Z=function(e){var t,a,i,r,c,o,d,v=e.offer,h=e.close,p=Object(n.useState)(!0),f=Object(u.a)(p,2),j=f[0],m=f[1],g=Object(n.useState)([]),O=Object(u.a)(g,2),x=O[0],_=O[1];Object(n.useEffect)((function(){Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K({offer_id:v.id,page_size:v.effectif});case 2:t=e.sent,_(t.results);case 4:case"end":return e.stop()}}),e)})))()}),[]);var y=Object(n.useCallback)((function(){m(!1)}),[]),w=Object(n.useCallback)((function(){h()}),[]);return Object(b.jsxs)(I.a,{onClosed:w,isOpen:j,unmountOnClose:!0,toggle:y,children:[Object(b.jsx)(J.a,{children:null===(t=v.activity)||void 0===t?void 0:t.name}),Object(b.jsxs)(R.a,{children:[Object(b.jsx)(W.a,{className:"mb-3",children:null===(a=v.activity)||void 0===a?void 0:a.description}),Object(b.jsxs)(W.a,{className:"mb-3",children:[Object(b.jsx)("h6",{children:"Teacher"}),Object(b.jsxs)("div",{className:"d-flex align-items-center",children:[Object(b.jsx)(X,{src:null===(i=v.coach)||void 0===i?void 0:i.photo,className:"me-2",alt:"Coach photo"}),Object(b.jsx)("span",{children:null===(r=v.coach)||void 0===r?void 0:r.name})]})]}),Object(b.jsxs)(W.a,{className:"mb-3",children:[Object(b.jsx)("h6",{children:null===(c=v.establishment)||void 0===c?void 0:c.title}),Object(b.jsx)("div",{children:null===(o=v.establishment)||void 0===o?void 0:o.specific_info})]}),Object(b.jsxs)(W.a,{className:"mb-3",children:[Object(b.jsx)("h6",{children:"Address"}),Object(b.jsx)("div",{children:null===(d=v.establishment)||void 0===d?void 0:d.address})]}),Object(b.jsxs)(W.a,{children:[Object(b.jsx)("h6",{children:"Registered members"}),Object(b.jsxs)("div",{children:[!x.length&&"There is no registered members...",!!x.length&&x.map((function(e){return Object(b.jsx)("div",{children:e.name},e.id)}))]})]})]}),Object(b.jsx)(F.a,{children:Object(b.jsx)(T.a,{onClick:y,children:"Got it"})})]})},$=E.a.div(q||(q=Object(H.a)(["\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),ee=function(e){var t,a,i,r,c,s,o,l,d,v,h,p=e.offer,f=Object(n.useMemo)((function(){return"".concat(S()(p.date_start).format("DD/MM/YYYY HH:mm")," - ").concat(S()(p.date_start).add(p.duration,"m").format("HH:mm"))}),[p.date_start,p.duration]),j=Object(n.useState)(!1),m=Object(u.a)(j,2),g=m[0],O=m[1],x=Object(n.useCallback)((function(){O((function(e){return!e}))}),[]);return Object(b.jsxs)(B.a,{className:"mb-2 position-relative",style:{borderBottomColor:null===(t=p.activity)||void 0===t?void 0:t.color,borderBottomWidth:2},children:[Object(b.jsx)(X,{className:"position-absolute top-0 start-0 mt-1 ms-1",src:null===(a=p.coach)||void 0===a?void 0:a.photo,alt:"Coach photo"}),Object(b.jsx)("div",{className:"card-img-top",style:{height:200,backgroundImage:"url(".concat(null===p||void 0===p||null===(i=p.activity)||void 0===i?void 0:i.cover_main,")"),backgroundSize:"cover"}}),Object(b.jsxs)(L.a,{children:[Object(b.jsx)("h5",{children:Object(b.jsx)($,{title:null===(r=p.activity)||void 0===r?void 0:r.name,children:null===(c=p.activity)||void 0===c?void 0:c.name})}),Object(b.jsxs)($,{children:[Object(b.jsx)("i",{className:"far fa-calendar"}),"  ",Object(b.jsx)("span",{title:f,children:f})]}),Object(b.jsxs)($,{children:[Object(b.jsx)("i",{className:"fas fa-location-arrow"})," ",Object(b.jsx)("span",{title:null===(s=p.establishment)||void 0===s?void 0:s.title,children:null===(o=p.establishment)||void 0===o?void 0:o.title})]}),Object(b.jsxs)($,{children:[Object(b.jsx)("i",{className:"fas fa-map-marker-alt"})," ",Object(b.jsx)("span",{title:null===(l=p.establishment)||void 0===l?void 0:l.address,children:null===(d=p.establishment)||void 0===d?void 0:d.address})]}),Object(b.jsxs)($,{children:[Object(b.jsx)("i",{className:"fas fa-user-tie"})," ",Object(b.jsx)("span",{title:null===(v=p.coach)||void 0===v?void 0:v.name,children:null===(h=p.coach)||void 0===h?void 0:h.name})]}),Object(b.jsxs)($,{children:["Level: ",Object(b.jsx)("span",{title:p.value,children:p.level})]}),Object(b.jsxs)($,{children:["Reserved slots: ",p.validated_booking_count,"/",p.effectif]}),g&&Object(b.jsx)(Z,{offer:p,close:x}),Object(b.jsx)(T.a,{size:"sm",className:"mt-2",onClick:x,children:"Show details"})]})]})},te={offers:[],total:0,size:10,page:0,fetching:!1},ae=function(){var e=Object(n.useState)([new Date,new Date]),t=Object(u.a)(e,2),a=t[0],i=t[1],r=function(e){var t=Object(n.useState)(e),a=Object(u.a)(t,2),i=a[0],r=a[1];return[i,Object(n.useCallback)((function(e){r((function(t){return Object(j.a)(Object(j.a)({},t),e)}))}),[r])]}(te),c=Object(u.a)(r,2),d=c[0],v=d.offers,m=d.total,g=d.size,O=d.page,x=d.fetching,_=c[1],y=Object(n.useCallback)((function(e){2===e.length&&(i(e),_({page:0,offers:[],total:0}))}),[]),w=Object(n.useCallback)(Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _({fetching:!0}),e.next=3,Y({min_date:S()(a[0]).format("YYYY-MM-DD"),max_date:S()(a[1]).format("YYYY-MM-DD"),page:O+1,page_size:g});case 3:t=e.sent,_({total:t.count,page:O+1,offers:[].concat(Object(o.a)(v),Object(o.a)(t.results)),fetching:!1});case 5:case"end":return e.stop()}}),e)}))),[v,m]);return Object(b.jsxs)(p.a,{className:"d-flex flex-column overflow-auto",children:[Object(b.jsx)("h3",{children:"Search for activities"}),Object(b.jsx)("div",{className:"mb-3",children:Object(b.jsx)(h,{value:a,onChange:y})}),Object(b.jsx)(p.a,{fluid:!0,style:{overflowY:"auto"},children:Object(b.jsxs)(A.a,{pageStart:0,element:"div",initialLoad:!0,className:"row",hasMore:!x&&(m>v.length||0===O),loadMore:w,loader:null,threshold:30,useWindow:!1,children:[v.map((function(e){return Object(b.jsx)(f.a,{sm:4,children:Object(b.jsx)(ee,{offer:e})},e.id)})),x&&Object(b.jsx)("div",{children:"Chargement..."})]})})]})};var ne=function(){return Object(b.jsx)("div",{className:"d-flex flex-column pt-2 pb-2 vh-100",children:Object(b.jsx)(ae,{})})};r.a.render(Object(b.jsx)(ne,{}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.e66048b6.chunk.js.map