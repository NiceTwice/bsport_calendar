(this.webpackJsonpbsport_calendar=this.webpackJsonpbsport_calendar||[]).push([[0],{85:function(e,t,a){"use strict";a.r(t);var n=a(1),i=(a(48),a(14)),r=a.n(i),c=a(4),s=a.n(c),o=a(13),l=a(9),u=a(12),d=(a(53),a(41)),b=a.n(d),p=a(2),h=function(e){var t=e.value,a=void 0===t?new Date:t,i=e.onChange,r=Object(n.useMemo)((function(){return{mode:"range",dateFormat:"d-m-Y"}}),[]);return Object(p.jsx)(b.a,{className:"form-control",onChange:i,options:r,value:a})},v=a(94),f=a(95),j=a(6);var m=a(24),O=a.n(m);O.a.defaults.headers.common={Authorization:"Token ".concat("8c5ba20bc481c4d2803325833a5cf54771f6ba45")};var g=function(e,t){return O.a.get(e,{params:t}).then((function(e){return e.data})).catch((function(e){throw e}))},x={offer:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.date_start,i=e.date,r=e.min_date,c=e.max_date,s=e.page,o=e.page_size;return g("https://api.staging.bsport.io/api/v1/offer/",{company:a,date:i,min_date:r,max_date:c,date_start:n,page:s,page_size:o})}},metaActivity:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.ids,i=e.page_size,r=e.page;return g("https://api.staging.bsport.io/api/v1/meta-activity/",{company:a,id__in:n.join(","),page_size:i,page:r})},get:function(e){var t=e.id;return g("https://api.staging.bsport.io/api/v1/meta-activity/".concat(t))}},coach:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.ids,i=e.page_size,r=e.page;return g("https://api.staging.bsport.io/api/v1/coach/",{company:a,id__in:n.join(","),page_size:i,page:r})},get:function(e){var t=e.id;return g("https://api.staging.bsport.io/api/v1/coach/".concat(t))}},establishment:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t,n=e.ids,i=e.page_size,r=e.page;return g("https://api.staging.bsport.io/api/v1/establishment/",{company:a,id__in:n.join(","),page_size:i,page:r})},get:function(e){var t=e.id;return g("https://api.staging.bsport.io/api/v1/establishment/".concat(t))}},establishmentLocation:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.company,a=void 0===t?6:t;return g("https://api.staging.bsport.io/api/v1/establishment/marker/",{company:a})}},booking:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.offer_id,a=e.page,n=e.page_size;return g("https://api.staging.bsport.io/api/v1/booking/",{offer:t,page:a,page_size:n})}},member:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.offer_id,a=e.ids,n=e.page,i=e.page_size;return g("https://api.staging.bsport.io/api/v1/member/",{offer:t,page:n,page_size:i,id__in:(null===a||void 0===a?void 0:a.length)?a.join(","):void 0})}}};function _(e){var t,a,n,i;return{id:e.id,name:null===(t=e.user)||void 0===t?void 0:t.name,first_name:null===(a=e.user)||void 0===a?void 0:a.first_name,last_name:null===(n=e.user)||void 0===n?void 0:n.last_name,photo:null===(i=e.user)||void 0===i?void 0:i.photo}}var y=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,x.coach.search(t);case 3:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return _(e)}))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function w(e){var t;return{id:e.id,title:e.title,address:null===(t=e.location)||void 0===t?void 0:t.address,specific_info:e.specific_info}}var k=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,x.establishment.search(t);case 3:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return w(e)}))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function z(e){return{id:e.id,name:e.name,cover_main:e.cover_main,description:e.description,color:e.color,rating:e.rating}}var N=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,x.metaActivity.search(t);case 3:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return z(e)}))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.offer.search(Object(j.a)({},t));case 2:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return{id:(t=e).id,booking_ids:t.bookings,level:t.level,slots:t.tot_slots,effectif:t.effectif,duration:t.duration_minute,validated_booking_count:t.validated_booking_count,date_start:t.date_start,establishment_id:t.establishment,coach_id:t.coach,activity_id:t.meta_activity};var t}))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(l.a)(s.a.mark((function e(t){var a,n,i,r,c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:return a=e.sent,e.next=5,Promise.all([N({ids:a.results.map((function(e){return e.activity_id})),page_size:a.results.length}),k({ids:a.results.map((function(e){return e.establishment_id})),page_size:a.results.length}),y({ids:a.results.map((function(e){return e.coach_id})),page_size:a.results.length})]);case 5:return n=e.sent,i=Object(u.a)(n,3),r=i[0],c=i[1],o=i[2],a.results=a.results.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{activity:r.results.find((function(t){return t.id===e.activity_id})),coach:o.results.find((function(t){return t.id===e.coach_id})),establishment:c.results.find((function(t){return t.id===e.establishment_id}))})})),e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=a(16),S=a.n(M),D=a(42),A=a.n(D),H=a(19),B=a(92),L=a(93),T=a(91),E=a(20),I=a(96),J=a(87),W=a(88),F=a(89),G=a(90);function P(e){return Object(j.a)({},e)}var R,q,K=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,x.member.search(t);case 3:return a=e.sent,e.abrupt("return",Object(j.a)(Object(j.a)({},a),{},{results:a.results.map((function(e){return P(e)}))}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=a(46),U=["className"],V=E.a.img(R||(R=Object(H.a)(["\n  width: 40px;\n  height: 40px;\n"]))),X=function(e){var t=e.className,a=Object(Q.a)(e,U);return Object(p.jsx)(V,Object(j.a)({className:"rounded-circle ".concat(t||"")},a))},Z=function(e){var t,a,i,r,c,o,d,b=e.offer,h=e.close,v=Object(n.useState)(!0),f=Object(u.a)(v,2),j=f[0],m=f[1],O=Object(n.useState)([]),g=Object(u.a)(O,2),x=g[0],_=g[1];Object(n.useEffect)((function(){Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K({offer_id:b.id,page_size:b.effectif});case 2:t=e.sent,_(t.results);case 4:case"end":return e.stop()}}),e)})))()}),[]);var y=Object(n.useCallback)((function(){m(!1)}),[]),w=Object(n.useCallback)((function(){h()}),[]);return Object(p.jsxs)(I.a,{onClosed:w,isOpen:j,unmountOnClose:!0,toggle:y,children:[Object(p.jsx)(J.a,{children:null===(t=b.activity)||void 0===t?void 0:t.name}),Object(p.jsxs)(W.a,{children:[Object(p.jsx)(F.a,{className:"mb-3",children:null===(a=b.activity)||void 0===a?void 0:a.description}),Object(p.jsxs)(F.a,{className:"mb-3",children:[Object(p.jsx)("h6",{children:"Teacher"}),Object(p.jsxs)("div",{className:"d-flex align-items-center",children:[Object(p.jsx)(X,{src:null===(i=b.coach)||void 0===i?void 0:i.photo,className:"me-2",alt:"Coach photo"}),Object(p.jsx)("span",{children:null===(r=b.coach)||void 0===r?void 0:r.name})]})]}),Object(p.jsxs)(F.a,{className:"mb-3",children:[Object(p.jsx)("h6",{children:null===(c=b.establishment)||void 0===c?void 0:c.title}),Object(p.jsx)("div",{children:null===(o=b.establishment)||void 0===o?void 0:o.specific_info})]}),Object(p.jsxs)(F.a,{className:"mb-3",children:[Object(p.jsx)("h6",{children:"Address"}),Object(p.jsx)("div",{children:null===(d=b.establishment)||void 0===d?void 0:d.address})]}),Object(p.jsxs)(F.a,{children:[Object(p.jsx)("h6",{children:"Registered members"}),Object(p.jsxs)("div",{children:[!x.length&&"There is no registered members...",!!x.length&&x.map((function(e){return Object(p.jsx)("div",{children:e.name},e.id)}))]})]})]}),Object(p.jsx)(G.a,{children:Object(p.jsx)(T.a,{onClick:y,children:"Got it"})})]})},$=E.a.div(q||(q=Object(H.a)(["\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),ee=function(e){var t,a,i,r,c,s,o,l,d,b,h,v=e.offer,f=Object(n.useMemo)((function(){return"".concat(S()(v.date_start).format("DD/MM/YYYY HH:mm")," - ").concat(S()(v.date_start).add(v.duration,"m").format("HH:mm"))}),[v]),j=Object(n.useState)(!1),m=Object(u.a)(j,2),O=m[0],g=m[1],x=Object(n.useCallback)((function(){g((function(e){return!e}))}),[]);return Object(p.jsxs)(B.a,{className:"mb-2 position-relative",style:{borderBottomColor:null===(t=v.activity)||void 0===t?void 0:t.color,borderBottomWidth:2},children:[Object(p.jsx)(X,{className:"position-absolute top-0 start-0 mt-1 ms-1",src:null===(a=v.coach)||void 0===a?void 0:a.photo,alt:"Coach photo"}),Object(p.jsx)("div",{className:"card-img-top",style:{height:200,backgroundImage:"url(".concat(null===v||void 0===v||null===(i=v.activity)||void 0===i?void 0:i.cover_main,")"),backgroundSize:"cover"}}),Object(p.jsxs)(L.a,{children:[Object(p.jsx)("h5",{children:Object(p.jsx)($,{title:null===(r=v.activity)||void 0===r?void 0:r.name,children:null===(c=v.activity)||void 0===c?void 0:c.name})}),Object(p.jsxs)($,{children:[Object(p.jsx)("i",{className:"far fa-calendar"}),"  ",Object(p.jsx)("span",{title:f,children:f})]}),Object(p.jsxs)($,{children:[Object(p.jsx)("i",{className:"fas fa-location-arrow"})," ",Object(p.jsx)("span",{title:null===(s=v.establishment)||void 0===s?void 0:s.title,children:null===(o=v.establishment)||void 0===o?void 0:o.title})]}),Object(p.jsxs)($,{children:[Object(p.jsx)("i",{className:"fas fa-map-marker-alt"})," ",Object(p.jsx)("span",{title:null===(l=v.establishment)||void 0===l?void 0:l.address,children:null===(d=v.establishment)||void 0===d?void 0:d.address})]}),Object(p.jsxs)($,{children:[Object(p.jsx)("i",{className:"fas fa-user-tie"})," ",Object(p.jsx)("span",{title:null===(b=v.coach)||void 0===b?void 0:b.name,children:null===(h=v.coach)||void 0===h?void 0:h.name})]}),Object(p.jsxs)($,{children:["Level: ",Object(p.jsx)("span",{title:v.value,children:v.level})]}),Object(p.jsxs)($,{children:["Slots: ",v.validated_booking_count,"/",v.effectif]}),O&&Object(p.jsx)(Z,{offer:v,close:x}),Object(p.jsx)(T.a,{size:"sm",className:"mt-2",onClick:x,children:"Show details"})]})]})},te={offers:[],total:0,size:10,page:0,fetching:!1},ae=function(){var e=Object(n.useState)([new Date,new Date]),t=Object(u.a)(e,2),a=t[0],i=t[1],r=function(e){var t=Object(n.useState)(e),a=Object(u.a)(t,2),i=a[0],r=a[1];return[i,Object(n.useCallback)((function(e){r((function(t){return Object(j.a)(Object(j.a)({},t),e)}))}),[r])]}(te),c=Object(u.a)(r,2),d=c[0],b=d.offers,m=d.total,O=d.size,g=d.page,x=d.fetching,_=c[1],y=Object(n.useCallback)((function(e){2===e.length&&(i(e),_({page:0,offers:[],total:0}))}),[]),w=Object(n.useCallback)(Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _({fetching:!0}),e.next=3,Y({min_date:S()(a[0]).format("YYYY-MM-DD"),max_date:S()(a[1]).format("YYYY-MM-DD"),page:g+1,page_size:O});case 3:t=e.sent,_({total:t.count,page:g+1,offers:[].concat(Object(o.a)(b),Object(o.a)(t.results)),fetching:!1});case 5:case"end":return e.stop()}}),e)}))),[b,m]);return Object(p.jsxs)(v.a,{className:"d-flex flex-column overflow-auto",children:[Object(p.jsx)("h3",{children:"Search for activities"}),Object(p.jsx)("div",{className:"mb-3",children:Object(p.jsx)(h,{value:a,onChange:y})}),Object(p.jsx)(v.a,{fluid:!0,style:{overflowY:"auto"},children:Object(p.jsxs)(A.a,{pageStart:0,element:"div",initialLoad:!0,className:"row",hasMore:!x&&(m>b.length||0===g),loadMore:w,loader:null,threshold:30,useWindow:!1,children:[b.map((function(e){return Object(p.jsx)(f.a,{sm:4,children:Object(p.jsx)(ee,{offer:e})},e.id)})),x&&Object(p.jsx)("div",{children:"Chargement..."})]})})]})};var ne=function(){return Object(p.jsx)("div",{className:"d-flex flex-column pt-2 pb-2 vh-100",children:Object(p.jsx)(ae,{})})};r.a.render(Object(p.jsx)(ne,{}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.9bbd9661.chunk.js.map